# Section 5.3 Estimating Continuous Distributions

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.height = 3.5, fig.width=4, fig.align = 'center')
```
_Sections 5.1 and 5.2 were incorporated into chapter 3 and 4._

Transferring a variable from one scale to another is a problem that is familiar to us. For instance, supposed that we know the temperature in degrees Fahrenheit . We can easily transfer the temperature to degrees Celsius using the formula $C=\frac{5}{9}(F-32)$. The following function in R will do this.

```{r}
degrees_F <- 85
(degrees_C <- 5/9*(degrees_F-32))
```

An analogous question arises in connection with random variables. Suppose that $X$ is a random variable with a certain probability distribution and $Y$ is another random variable that is some function of $X$, say $aX+b$ where $a$ and $b$ are constants. What can we say about the distribution of $Y$?

In this section, we will use simulation to answer questions about the distribution of random variables that are transformations or combinations of different random variables.

### Example
Suppose $X$ is a normally distributed random variable with mean of 5 and standard deviation of 1. We can easily simulate drawing random samples from this distribution using the function `rnorm`.

If we viewed a histogram of the $X$ we would expect the histogram to be bell-shaped, centered at around 5. Because the standard deviation is equal to 1 we would expect that almost all values will be between 2 and 8 ($\mu \pm 3\sigma$).

\newpage
\singlespace
```{r}
X <- rnorm(1000,5,1)
hist(X)
```
\doublespace

For distributions where the pdf is continuous, we may also use a *density estimation*. The height of the density estimation is a weighted sum of the distances to all of the data points in the sample. We can overlay the density curve over the histogram. This will result in a smooth curve and will give us an idea of how a certain distribution "fits" with the simulated data. 
\singlespace
```{r}
hist(X,prob=TRUE)
curve(dnorm(x,5,1),add=TRUE,col="red")
```
\vspace{-0.5cm}
Not surprisingly, we can see that the red curve matches the curve in the histogram.
\doublespace

\newpage
We can change the number of bins to get a closer look at the fit of the simulated data to the normal distribution.
\singlespace
```{r,out.width="50%", fig.align='center'}
hist(X,prob=TRUE,nclass=40)
curve(dnorm(x,5,1),add=TRUE,col="red")
```
\doublespace

Although not perfect, it would be hard to argue that the data that we simulated didn't follow a normal distribution with mean of 5 and standard deviation of 1. Of course since we created the data we know that it does arise from N(5,1). In practice, we don't usually know the exact distribution that data arise from so we want methods to decide whether the data fit with a particular distribution. There are specific tests that we could do called _Goodness of fit tests_, however, simulation to check to see whether a random variable follows a specific distribution.

Now suppose that we have a different random variable $Y$ where $Y=10X+7$. What can we say about the distribution of $Y$? Let's consider what we already know about the distribution.

We know that $E(X)=5$ and $SD(X)=1$. Compute $E(Y)$ and $SD(Y)$.


\newpage

Now that we know the mean and standard deviation of $Y$ we might be interested in the shape of the distribution of $Y$. We know that $X$ is normally distributed. What might be your best guess as to the distribution of $Y$?

\vspace{2cm}

We can use simulation to see if $Y$ follows a normal distribution centered at 57 with standard deviation of 10. We will do this in 3 steps:

1. 
\vspace{2cm}
2. 
\vspace{2cm}
3. 
\vspace{2cm}


It appears that if we take a linear transformation of a random variable $X$, say $Y=aX+b$ where $a$ and $b$ are constants and where $X$ follows a normal distribution with mean $\mu$ and standard deviation $\sigma$, we end up with a random variable $Y$ that also follows a normal distribution with mean $a\mu+b$ and variance $a^{2}\sigma^2$. More concisely, if $X\sim N(\mu,\sigma^{2})$ and $Y=aX+b$ where $a$ and $b$ are constants, then $Y\sim N(a\mu+b,a^{2}\sigma^{2})$.

\newpage

### You try it

Let $X \sim N(10,2)$ and $Y = 3x-5$. What is the distribution of $Y$? Show all work. 

* Find the theoretical mean and variance: 

\vspace{5cm}

* Use the 3 steps above to simulate a distribution of $Y$. 

\vspace{6cm}

Of course, we are generalizing our example to all linear transformations of normal variables. It turns out that we can prove mathematically that the above result holds fairly easily. Our simulation didn't prove that the above result is true, however, it lead us to believe that perhaps the result holds for all linear transformations of a single variable $X$.

\newpage

## Transformations of combinations of random variables. 

### Example

Suppose that $Z_{1}$ and $Z_{2}$ are independent standard normal variables. Simulate the pdf of $Z_{1}-Z_{2}$ and check whether or not $Z_{1}-Z_{2}$ follows a $N(0,\sqrt{2})$.

\vspace{4cm}

## Theorem 5.2

Let $X_{1},...,X_{n}$ be mutually independent normal random variables with means $\mu_{1},...,\mu_{n}$ and standard deviation $\sigma_{1},...,\sigma_{n}$. Then the random variable $\sum a_{i}X_{i}$ is a normal random variable with mean $\sum a_{i}\mu_{i}$ and standard deviation $\sqrt{\sum a_{i}^{2}\sigma_{i}^{2}}$.


### You try it
1. Let $X \sim N(4,2)$ and $Y \sim N(-2, 1)$. Find and plot the distribution of $Z = 2x-4Y$. 


\newpage

2. Let $X$ and $Y$ be independent uniform random variables on the interval [0,1]. 

a. Guess and write down a hypothesized distribution for $Z = X+Y$. 

\vspace{2cm}

b. Simulate the pdf of $Z$ and plot it. Sketch the plot in these notes, including a detailed x-axis. Is it as you expected? 

\vspace{3cm}

c. Describe it's shape. Is this reasonable from a geometric perspective? Explain why. 

\vspace{3cm}

d. Using the theoretical mean and variance, and the named distribution that best matches the shape above (regardless of your answer in part a), plot a distribution curve over the histogram and describe how well the simulation fits the hypothesized distribution


\newpage

### Exercise

Suppose we have 2 random variables where $X_{1}$ and $X_{2}$ follows an exponential distribution with $\lambda=3$. Use simulation to show that $X_{1}+X_{2}$ follows a $\Gamma\sim(2,3)$.

\vspace{5cm}

It turns out that if we have the sum of $n$ exponential random variables with parameter $\lambda$, we get......



